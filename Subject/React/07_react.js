---------------------------------------------------------------------------------------------  
‚ãô ‚ùç –ù–∞–ø–∏—Å–∞—Ç—å hook –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
---
7. 
‚åõ –ù–∞–ø–∏—à–∏ React hook —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º useFetch, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ URL –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±–æ–µ API, –¥–∞–∂–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–∏–¥—É–º–∞–Ω–Ω–æ–µ. –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∞–¥—Ä–µ—Å—É –±—É–¥–µ—Ç JSON, –∑–∞–≥—Ä—É–∂–∞–µ–º –º–µ—Ç–æ–¥–æ–º GET, –Ω–∏–∫–∞–∫–∏—Ö –¥—Ä—É–≥–∏—Ö –º–µ—Ç–æ–¥–æ–≤, –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ò–º–ø–æ—Ä—Ç—ã –º–æ–∂–Ω–æ –Ω–µ –ø–∏—Å–∞—Ç—å.
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–∞—é —Ç–∞–∫–æ–π "—à–∞–±–ª–æ–Ω" —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏:
function useFetch(url) {
  // TODO
}

// usage
function Component({ url }) {
  ........ = useFetch(url);

  return <>
	...
  </>
}
–Ø –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –Ω–µ –¥–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –Ω–∞–¥–æ –≤–µ—Ä–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø—Ä–µ–¥–ª–∞–≥–∞—é –∫–∞–Ω–¥–∏–¥–∞—Ç—É —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å API —ç—Ç–æ–≥–æ hook'–∞.
üéØ –ó–∞–¥–∞—á–∫–∞ "–º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è". –ú–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è:
function useFetch(url) {
	const [data, setData] = useState(null);

	useEffect(() => {
		fetch(url)
			.then((res) => res.json())
			.then((respData) => setData(respData));
	}, []);

	return data;
}
–≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –º–∏–Ω–∏–º—É–º —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞–¥–æ –Ω–∞—á–∏–Ω–∞—Ç—å. –ò–Ω–æ–≥–¥–∞ –¥–∞–∂–µ —ç—Ç–æ –Ω–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å. –°–æ–∏—Å–∫–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –≤–µ—Ä–Ω—É—Ç—å –∏–∑ hook Promise –∏ "–∑–∞—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å" –µ–≥–æ –≤ –Ω–∞–¥–µ–∂–¥–µ –Ω–∞ —á—É–¥–æ, –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±–º–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ö—É–∫–∞ async/await –∏ —Ç.–¥. –ò–Ω–æ–≥–¥–∞ –≤—Å—è –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ - —Ç—É—Ç —è –ø—Ä–æ—à—É –≤—Å–µ —ç—Ç–æ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ hook.
–î–∞–ª—å—à–µ –Ω—É–∂–Ω–æ –æ—Å–æ–∑–Ω–∞—Ç—å, —á—Ç–æ –≤ —ç—Ñ—Ñ–µ–∫—Ç–µ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ï—Å–ª–∏ url –∏–∑–º–µ–Ω–∏—Ç—Å—è, —Ç–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç.
function useFetch(url) {
	const [data, setData] = useState(null);

	useEffect(() => {
		setData(null); // –Ω–µ –∑–∞–±—ã—Ç—å —Å–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
		fetch(url)
			.then((res) => res.json())
			.then((respData) => setData(respData));
	}, [url]); // <-- –Ω–µ –∑–∞–±—ã—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

	return data;
}
–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è, –∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã, –∫–∞–∫ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —ç—Ç–æ—Ç hook. –•–æ—á–µ—Ç—Å—è —á—Ç–æ –±—ã –∫–∞–Ω–¥–∏–¥–∞—Ç –∫–∞–∫ –º–∏–Ω–∏–º—É–º –ø—Ä–µ–¥–ª–æ–∂–∏–ª –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É –∏ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
function useFetch(url) {
	const [data, setData] = useState(null);
	const [isLoading, setIsLoading] = useState(false);
	const [error, setError] = useState(null);

	useEffect(() => {
		// –Ω–µ –∑–∞–±—ã—Ç—å –≤—Å–µ —Å–±—Ä–æ—Å–∏—Ç—å
		setIsLoading(true);
		setData(null);
		setError(null);
		fetch(url)
			.then((res) => res.json())
			.then((respData) => setData(respData))
			.catch((e) => setError(e)) // –Ω–µ –∑–∞–±—ã—Ç—å –ø–æ–π–º–∞—Ç—å –æ—à–∏–±–∫—É
			.finally(() => setIsLoading(false)); // –Ω–µ –∑–∞–±—ã—Ç—å —Å–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
	}, [url]);

	return [data, isLoading, error];
}
–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ - –ø–æ–Ω—è—Ç—å, —á—Ç–æ –≤ —ç—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–µ–Ω race condition. –ï—Å–ª–∏ –º—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—Ä–æ—Å–∏–º –¥–≤–∞ URL, –∏ —Ç–∞–∫ –ø–æ–ª—É—á–∏—Ç—Å—è, —á—Ç–æ –ø–µ—Ä–≤—ã–π –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –¥–æ–ª–≥–æ, –∞ –≤—Ç–æ—Ä–æ–π –±—ã—Å—Ç—Ä–æ, —Ç–æ –º—ã –ø–æ–ª—É—á–∏–º —Å–ø–µ—Ä–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç –≤—Ç–æ—Ä–æ–≥–æ –∞–¥—Ä–µ—Å–∞, –∞ –∑–∞—Ç–µ–º –æ—Ç –ø–µ—Ä–≤–æ–≥–æ. –í –∏—Ç–æ–≥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –î–∞–ª–µ–∫–æ –Ω–µ –≤—Å–µ –¥–æ–±–∏—Ä–∞—é—Ç—Å—è –¥–æ —ç—Ç–æ–≥–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –ú–æ–∂–Ω–æ –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å, –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–¥—É–º–∞—Ç—å, –∫–∞–∫ –±—É–¥—É—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è —Å–æ–±—ã—Ç–∏—è, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è, –æ–¥–∏–Ω –±—ã—Å—Ç—Ä–µ–µ, –¥—Ä—É–≥–æ–π –º–µ–¥–ª–µ–Ω–Ω–µ–µ.
–†–µ—à–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å —á–µ—Ä–µ–∑ AbortController (–≤ —Å–ª—É—á–∞–µ fetch –∏–ª–∏ –≤ —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è axios), –Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - —Å –ø–æ–º–æ—â—å—é –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π

function useFetch(url) {
   const [data, setData] = useState(null);
   const [isLoading, setIsLoading] = useState(false);
   const [error, setError] = useState(null);

   useEffect(() => {
      // —Ñ–ª–∞–≥ –æ—Ç–º–µ–Ω—ã
      let cancelled = false;

      setIsLoading(true);
      setData(null);
      setError(null);
      fetch(url)
         .then((res) => res.json())
         .then((respData) => {
            if (!cancelled) setData(respData);
         })
         .catch((e) => {
            if (!cancelled) setError(e);
         })
         .finally(() => {
            if (!cancelled) setIsLoading(false);
         });

      return () => {
         // –≤—ã—Å—Ç–∞–≤–∏–º –ø—Ä–∏–∑–Ω–∞–∫ —Ç–æ–≥–æ, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –æ—Ç–º–µ–Ω–µ–Ω
         cancelled = true;
      };
   }, [url]);

   return [data, isLoading, error];
}

–í–æ—Ç –≥–æ—Ç–æ–≤—ã–π React hook useFetch, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É URL. –û–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É, –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç race condition —Å –ø–æ–º–æ—â—å—é –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π cancelled.
–í–æ—Ç —Ç–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —è —Å—á–∏—Ç–∞—é "–∏–¥–µ–∞–ª—å–Ω—ã–º" (–æ–±—Å—É–¥–∏–º –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, —á—Ç–æ –º–æ–∂–Ω–æ –µ—â–µ —É–ª—É—á—à–∏—Ç—å?).
–ó–∞–¥–∞—á–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç –ø–æ–Ω–∏–º–∞–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ React, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏, –∫–∞–∫ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å—Å—è –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ "–æ—á–∏—Å—Ç–∫–∞ (cleanup) —ç—Ñ—Ñ–µ–∫—Ç–∞", –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç—ã.
---------------------------------------------------------------------------------------------
